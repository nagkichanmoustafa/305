<!DOCTYPE html>
<html lang="en-US">
<SCRIPT LANGUAGE="JavaScript"></SCRIPT>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">

    <style>
        body {
            max-width: 440px;
        }
        
        pre {
            overflow-x: auto;
        }
    </style>
</head>

<body>

    <body>

        <h2 id=title></h2>
        x = <input type=number id=ex value=0 onChange="calculate()"> &emsp; DF1 = <input type=number id=df1 value=1 onChange="calculate()"> &emsp; DF2 = <input type=number id=df2 value=1 onChange="calculate()"> &emsp;
        <span id=res></span>
        <pre id=out><b>Table</b></pre>

        <hr />
        <b>Sample code</b>
        <pre id=sample></pre>

        <hr />

        </p>


        <script>
            function LogGamma(Z) {
                with(Math) {
                    var S = 1 + 76.18009173 / Z - 86.50532033 / (Z + 1) + 24.01409822 / (Z + 2) - 1.231739516 / (Z + 3) + .00120858003 / (Z + 4) - .00000536382 / (Z + 5);
                    var LG = (Z - .5) * log(Z + 4.5) - (Z + 4.5) + log(S * 2.50662827465);
                }
                return LG
            }

            function Betinc(X, A, B) {
                var A0 = 0;
                var B0 = 1;
                var A1 = 1;
                var B1 = 1;
                var M9 = 0;
                var A2 = 0;
                var C9;
                while (Math.abs((A1 - A2) / A1) > .00001) {
                    A2 = A1;
                    C9 = -(A + M9) * (A + B + M9) * X / (A + 2 * M9) / (A + 2 * M9 + 1);
                    A0 = A1 + C9 * A0;
                    B0 = B1 + C9 * B0;
                    M9 = M9 + 1;
                    C9 = M9 * (B - M9) * X / (A + 2 * M9 - 1) / (A + 2 * M9);
                    A1 = A0 + C9 * A1;
                    B1 = B0 + C9 * B1;
                    A0 = A0 / B1;
                    B0 = B0 / B1;
                    A1 = A1 / B1;
                    B1 = 1;
                }
                return A1 / A
            }

            function Betacdf(Z, A, B) {
                var S;
                var BT;
                var Bcdf;
                with(Math) {
                    S = A + B;
                    BT = Math.exp(LogGamma(S) - LogGamma(B) - LogGamma(A) + A * Math.log(Z) + B * Math.log(1 - Z));
                    if (Z < (A + 1) / (S + 2)) {
                        Bcdf = BT * Betinc(Z, A, B)
                    } else {
                        Bcdf = 1 - BT * Betinc(1 - Z, B, A)
                    }
                }
                return Bcdf
            }

            function calculate() {
                let X = eval(ex.value)
                let f1 = eval(df1.value)
                let f2 = eval(df2.value);
                if (f1 <= 0) {
                    alert("Numerator degrees of freedom must be positive")
                } else if (f2 <= 0) {
                    alert("Denominator degrees of freedom must be positive")
                } else if (X <= 0) {
                    Fcdf = 0
                } else {
                    let Z = X / (X + f2 / f1);
                    Fcdf = Betacdf(Z, f1 / 2, f2 / 2);
                }
                Fcdf = Math.round(Fcdf * 100000) / 100000;
                res.innerText = 'Result = ' + Fcdf;
            }


            /*

                function t_Dist(x, n, f = 4) {
                    let s = Math.pow((x / (n - 1)), 2)
                    let s1 = Math.sqrt(s)
                    let m = x / n;
                    let t = (x - m) / (s1 / Math.sqrt(n));
                    return t.toFixed(f)
                }

                function calculate() {
                    let x = Number(ex.value)
                    if (!Number.isInteger(x)) {
                        x = Math.round(x);
                        ex.value = x
                    }
                    let n = Number(lam.value)
                    res.innerText = "P(x, n) = " + t_Dist(x, n);
                }
*/
            function doTable() {
                const α = [0.0005, 0.001, 0.005, 0.010, 0.025, 0.05, 0.1]
                let a = α.map((n) => 'α= ' + n)
                let str = header(a)
                for (let x = 0; x <= 7; x++) {
                    let a = α.map((α) => t_Dist(x, n))
                    str += oneLine(a, x)
                }
                return str
            }

            let header = (a) => '      ' + a.join('   ')
            let oneLine = (a, x) => '\nx=' + x + '  ' + a.join(' ')

            //title.innerText = document.title
            sample.innerText = doTable + '\n' + calculate
            calculate()
                // out.innerText = doTable()
        </script>

    </body>

</html>